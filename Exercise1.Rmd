---
title: "Timothy Gan, Randal Donaldson"
output: github_document
---

```{r, setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
#library(mosaic)
ABIA = read.csv("data/ABIA.csv")
creatinine = read.csv("data/creatinine.csv")
lm1 = lm(creatclear ~ age, data = creatinine)
```

## GitHub Documents

This is an R Markdown format used for publishing markdown documents to GitHub. When you click the **Knit** button all R code chunks are run and a markdown file (.md) suitable for publishing to GitHub is generated.

## ABIA

Look at these departure delays!

```{r, ABIA, message=TRUE, warning=TRUE, echo=FALSE}

security_summ = ABIA %>%
  group_by(DayOfWeek)  %>%  # group the data points by model name
  summarize(DepartureDelay.mean = mean(DepDelay, na.rm=TRUE))  # calculate a mean for each model

ggplot(security_summ, aes(x=DayOfWeek, y=DepartureDelay.mean)) + 
  geom_bar(stat='identity')
```
```

## Creatinine

Scatter plot of age vs creatinine clearance rate

```{r, creatinine1, echo=FALSE}
plot(creatclear ~ age, data = creatinine)
```

We found a first order polynomial to work fine, as a second order polynomial looked pretty much like a straight line. A first order regression gives us the equation:

creatclear = (age * -.619) + 147.81
```{r, creatinine2, echo=FALSE}
plot(creatclear ~ age, data = creatinine)
abline(147.81, -0.619)
```

We run the linear equation in R with x = 55 to predict the creatclear of a 55 year old:
```{r, creatinine3}
coef(lm1)[1] + 55*coef(lm1)[2]
``` 

According to our linear regression, creatinine clearance decreases at a rate of .619 mL/minute per year.

